#!/usr/bin/sage

from Crypto.Util.number import long_to_bytes
n = 25672717426820513710943205839364483916462804218548801569145802652630577782900538695973744861105496729905627921059008367561569523305960463813216527736798326653292438086191944762789172647312900551902461060352376019547331143616013304184614930906004171476480510470587909456774815137176855734430612064982542863659570395295482686120891117968898216622206615854128611416469340618239366172641009539517658878551692132791618016300846596344387852192596993173217855138296633962850557028630352495932230646527202752234601562497215822764663650767710458962369922520233739420580532819716680556394145993527683129009216404336549252330091
e = 65537
phi = 25672717426820513710943205839364483916462804218548801569145802652630577782900538695973744861105496729905627921059008367561569523305960463813216527736798326653292438086191944762789172647312900551902461060352376019547331143616013304184614930906004171476480510470587909456774815137176855734430612064982542863659249572422114357286915580400207489328270951787756538202817904605893559597117295966072478557940874642555753081937470818042924909751287326372258502618933738347941205709816109495280674892920038359548721227977768797512507672901442972834794816377217062238255225318298101342089489811138866063872648424919799079101472
flag = 1083625496779970264419136305221671016117829663020044050146555349899787834011590086920869802111023991613821066623716559972755949113701501874048562224439274720251945134284083684492761219205132838372764452677281768274305372099912532025957284473071373317196230163363640098605346443685525909370527747332955548675206412274584950839734716346547094425347696118475715583261416077609393966266153722274187119120682987915292966511175589928588362998907734884276112744211599285641171140402681639667044788628645470007439249161157400845406659256582870356000464445445478989477502854810644166856995360456670068896815610415108264478323
n2 = 27368115041311256275227024917950858454235788667021073198311116355186647544767717811973935453582324380335430354834788466153181148557334562671645375401434653132878379082952166788670952485522953276925557458943115441308780807836250927064634092981175701891508525682899992903672949137706472233445943878804298329629278526495430527687968010293979124319259469576481820335370026921880073228386101660016332613679667679937345493922150203642222273091669777337735254184786282363582190082715868568569189222774625804615657773286270123197871252891782578640230520633961840128629257859130644151809317074356832564646866829943858656213303

# n = pq, phi = pq-p-q-1, so p+q = n-phi+1
sum = n - phi + 1

# generate polynomial with roots p and q
x = PolynomialRing(RationalField(), 'x').gen()
poly = x^2 - sum*x + n
p, q = poly.roots()[0][0], poly.roots()[1][0]

# find the other factor of n2
if n2 % p == 0:
    q2 = n2 / p
    p2 = p
else:
    q2 = n2 / q
    p2 = q

# decrypt the flag
d = pow(e, -1, (p2-1)*(q2-1))
flag = pow(flag, d, n2)
print(long_to_bytes(flag))